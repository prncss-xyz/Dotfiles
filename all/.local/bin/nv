#!/usr/bin/env sh

# This is my 'clone' of Notational velocity! ;-)

if [ -n "NV_DIR" ]; then
  notes="$NV_DIR"
else
  notes=~/Notes
fi
mkdir -p "$notes"
cd "$notes"
result=$(fd -e md -x echo '{.}'|fzf --history=$HOME/.histories/nv --print-query|tail -1)
if [ -n "$result" ]; then
  if [ ! -f "$result.md" ]; then
    dir=$(dirname "$result")
    file=$(basename "$result")
    mkdir -p "$dir"
    echo "# $file" > "$result.md"
  fi
  if [ -n "$1" ] && [ "$1" = "gui" ]; then
    exec "$GUI" "$EDITOR" "$notes/$result.md"
  else
    exec "$EDITOR" "$result.md"
  fi
fi

