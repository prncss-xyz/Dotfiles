#!/usr/bin/env bash

name="$1"

step() {
	# dir dir/name.ext dir/name.ext.esh
	mkdir -p ~/"$1"
  echo $1 $2 $3
  echo "envsubst" '< ' "$HOME/.config/theming/$3/$2" ">" ~/"$2"
  envsubst < "$HOME/.config/theming/$3/$2" > ~/"$2"
}
export -f step

source ~/.config/theming/generated/"$name".sh

export text="$foreground"
export accent="$color6"
export primary="$color12"
export font="Montserrat"

source ~/.config/theming/extra/"$name".sh

fd -H --type l --base-directory ~/.config/theming/skeleton -x sh -c 'step {//} {} skeleton'
echo 'bis'
if [ -d "$HOME/.config/theming/$name" ]; then
  echo 'ter'
	fd -H --type l --base-directory "$HOME/.config/theming/specific/$name" -x sh -c "step {//} {} specific/$name"
fi
